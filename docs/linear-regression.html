<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 1 Linear Regression | Statistics for Economics with R</title>
  <meta name="description" content="Chapter 1 Linear Regression | Statistics for Economics with R" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 1 Linear Regression | Statistics for Economics with R" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 1 Linear Regression | Statistics for Economics with R" />
  
  
  

<meta name="author" content="Logan Kelly, Ph.D." />


<meta name="date" content="2020-11-17" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="dealing-with-catagorical-data.html"/>
<script src="libs/header-attrs-2.4/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Statistics for Economics with R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="linear-regression.html"><a href="linear-regression.html"><i class="fa fa-check"></i><b>1</b> Linear Regression</a>
<ul>
<li class="chapter" data-level="1.1" data-path="linear-regression.html"><a href="linear-regression.html#r-packages-used-in-this-chapter"><i class="fa fa-check"></i><b>1.1</b> R Packages Used in this Chapter</a></li>
<li class="chapter" data-level="1.2" data-path="linear-regression.html"><a href="linear-regression.html#assumptions-of-the-classical-linear-regression-model"><i class="fa fa-check"></i><b>1.2</b> Assumptions of the Classical Linear Regression Model</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="linear-regression.html"><a href="linear-regression.html#linearity"><i class="fa fa-check"></i><b>1.2.1</b> Linearity</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="dealing-with-catagorical-data.html"><a href="dealing-with-catagorical-data.html"><i class="fa fa-check"></i><b>2</b> Dealing with Catagorical Data</a></li>
<li class="chapter" data-level="3" data-path="dealing-with-heteroscdaticity-and-nonlinearity.html"><a href="dealing-with-heteroscdaticity-and-nonlinearity.html"><i class="fa fa-check"></i><b>3</b> Dealing with Heteroscdaticity and Nonlinearity</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Statistics for Economics with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="linear-regression" class="section level1" number="1">
<h1><span class="header-section-number">Chapter 1</span> Linear Regression</h1>
<script src=https://cdn.datacamp.com/datacamp-light-latest.min.js></script>
<script>var element =  $("div[class="book"]");element.classList.remove("with-summary");</script>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="linear-regression.html#cb1-1" aria-hidden="true"></a><span class="cf">if</span> (<span class="op">!</span><span class="kw">require</span>(<span class="st">&quot;tidyverse&quot;</span>)) <span class="kw">install.packages</span>(<span class="st">&quot;tidyverse&quot;</span>)</span>
<span id="cb1-2"><a href="linear-regression.html#cb1-2" aria-hidden="true"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb1-3"><a href="linear-regression.html#cb1-3" aria-hidden="true"></a></span>
<span id="cb1-4"><a href="linear-regression.html#cb1-4" aria-hidden="true"></a><span class="cf">if</span> (<span class="op">!</span><span class="kw">require</span>(<span class="st">&quot;Rmisc&quot;</span>)) <span class="kw">install.packages</span>(<span class="st">&quot;Rmisc&quot;</span>)</span>
<span id="cb1-5"><a href="linear-regression.html#cb1-5" aria-hidden="true"></a><span class="kw">library</span>(Rmisc)</span>
<span id="cb1-6"><a href="linear-regression.html#cb1-6" aria-hidden="true"></a></span>
<span id="cb1-7"><a href="linear-regression.html#cb1-7" aria-hidden="true"></a><span class="cf">if</span> (<span class="op">!</span><span class="kw">require</span>(<span class="st">&quot;psych&quot;</span>)) <span class="kw">install.packages</span>(<span class="st">&quot;psych&quot;</span>)</span>
<span id="cb1-8"><a href="linear-regression.html#cb1-8" aria-hidden="true"></a><span class="kw">library</span>(psych)</span></code></pre></div>
<div id="r-packages-used-in-this-chapter" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> R Packages Used in this Chapter</h2>
<p>Base R has a great deal of functionality, but the real power of R is that thousands of people developing packages that expand the capabilities of R. In his chapter we will be using the following packages.</p>
<ul>
<li><p><code>tidyverse</code> The tidyverse is an opinionated collection of R packages designed for data science. All packages share an underlying design philosophy, grammar, and data structures (see <a href="https://www.tidyverse.org/" class="uri">https://www.tidyverse.org/</a>).</p></li>
<li><p><code>Rmisc</code> The Rmisc library contains many functions useful for data analysis and utility operations (see <a href="https://cran.r-project.org/web/packages/Rmisc/index.html" class="uri">https://cran.r-project.org/web/packages/Rmisc/index.html</a>).</p></li>
<li><p><code>psych</code> A general purpose toolbox for personality, psychometric theory and experimental psychology (see <a href="https://cran.r-project.org/web/packages/psych/index.html" class="uri">https://cran.r-project.org/web/packages/psych/index.html</a>)</p></li>
</ul>
<p>The following code chunk test weather each package has been installed, installs the package if needed, and then loads the package.</p>
<p><code>install.packages()</code> command installs the package and the <code>library()</code> command loads the package. For now, you can copy this code and paste this code to use it in your own analysis.</p>
</div>
<div id="assumptions-of-the-classical-linear-regression-model" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Assumptions of the Classical Linear Regression Model</h2>
<ol style="list-style-type: decimal">
<li>The dependent variable is <strong>linearly</strong> related to the coefficients of the model and the model is correctly specified.</li>
<li>No perfect <strong>multicollinearity.</strong> No independent variable has a perfect linear relationship with any of the other independent variables.</li>
<li>The <strong>mean</strong> of the <strong>error</strong> term is <strong>zero.</strong></li>
<li>The error term has a <strong>constant variance.</strong> No heteroscedasticity.</li>
<li>The error term is <strong>normally distributed.</strong> (Not absolutely necessary)</li>
<li>The error terms are <strong>uncorrelated</strong> with each other. No autocorrelation or serial correlation.</li>
<li>The <strong>independent variable(s)</strong> is/are <strong>uncorrelated</strong> with the equation <strong>error term.</strong></li>
</ol>
<div id="linearity" class="section level3" number="1.2.1">
<h3><span class="header-section-number">1.2.1</span> Linearity</h3>
<p>To use linear regression, the relationship we are studying must be linear. Duh, right? But is is a very common mistake to assume linearity without checking. The best way to check is to plot the data using scatter plots. Let’s use a famous data set known as <em>Anscombe’s Quartet</em> as an example of identifying linear and non linear relationships. <em>Anscombe’s Quartet</em> is a set of four pairs of x/y data that all yield identical regression output.</p>
<p>Look at the summary statistics fro <em>Anscombe’s Quartet</em>.</p>
<div data-datacamp-exercise="" data-height="300" data-encoded="true">
eyJsYW5ndWFnZSI6InIiLCJzYW1wbGUiOiIjIyBMb2FkIHBzeWNoIHBhY2thZ2VcbmlmICghcmVxdWlyZShcInBzeWNoXCIpKSBpbnN0YWxsLnBhY2thZ2VzKFwicHN5Y2hcIilcbmxpYnJhcnkocHN5Y2gpXG5cbiMjIExvYWQgYW5kIGRlc2NyaWJlIEFuc2NvbWJlJ3MgUXVhcnRldFxuZGF0YShcImFuc2NvbWJlXCIpXG5kZXNjcmliZShhbnNjb21iZSwgc2tldyA9IEYscmFuZ2VzID0gRikifQ==
</div>
<div class="code_note">
<p>The <code>data()</code> command loads built in R data sets. R has several built in data sets for learning R. <code>data("anscombe")</code> loads <em>Anscombe’s Quartet</em>.</p>
<p>The <code>describe()</code> command is from the <code>psych</code> package. You will sometimes see this indicated in documentation as follows: <code>psych::describe()</code> it does a nicer job of presenting summary statistics. The arguments skew and ranges are bothe set to false to keep the output simple.</p>
</div>
<p>Notice that the summary statistics fore each of the x’s and for each of the y’s are nearly identical. Now let’s look at the output from linear regression of the first and second x/y’s of the data set. In R, the <code>lm()</code> command is used to estimate linear regression models. The “lm” stands for linear model.</p>
<div data-datacamp-exercise="" data-height="300" data-encoded="true">
eyJsYW5ndWFnZSI6InIiLCJzYW1wbGUiOiJhbnNjb21iZS5sbTAxIDwtIGxtKHkxIH4geDEsIGRhdGEgPSBhbnNjb21iZSlcbnN1bW1hcnkoYW5zY29tYmUubG0wMSlcbmFuc2NvbWJlLmxtMDIgPC0gbG0oeTIgfiB4MiwgZGF0YSA9IGFuc2NvbWJlKVxuc3VtbWFyeShhbnNjb21iZS5sbTAyKSJ9
</div>
<div class="code_note">
<p><code>lm()</code> is used to fit linear models. The first argument is the formula. the dependent variable is listed first followed by a <code>~</code>, i.e. a tilde. Then the independent, or predictor, variables are listed. The <code>+</code> (plus) sign is used to separate each independent variable. Note that the output of <code>lm()</code> is not very useful. You need to store the linear model in an object and then use the <code>summary()</code> to display the regression output.</p>
</div>
<p>Notice that the regression output for the first set of x/y’s is nearly identical to the second x/y’s, but before we draw any conclusions, let’s check that relationships are linear. We will do this by first plotting a scatter plot of x vs y for each pair. Then we will plot the <em>residue vs fit plot</em>.</p>
<p>To plot a scatter plot of x vs y for each pair we will use a tool from the <code>tidyverse</code> called <code>ggplot</code>.</p>
<div data-datacamp-exercise="" data-height="600" data-encoded="true">
eyJsYW5ndWFnZSI6InIiLCJwcmVfZXhlcmNpc2VfY29kZSI6ImlmICghcmVxdWlyZShcImdncGxvdDJcIikpIGluc3RhbGwucGFja2FnZXMoXCJnZ3Bsb3QyXCIpXG5saWJyYXJ5KGdncGxvdDIpXG5pZiAoIXJlcXVpcmUoXCJkcGx5clwiKSkgaW5zdGFsbC5wYWNrYWdlcyhcImRwbHlyXCIpXG5saWJyYXJ5KGRwbHlyKSIsInNhbXBsZSI6ImFuc2NvbWJlICU+JSBnZ3Bsb3QoYWVzKHg9eDEseT15MSkpICtcbiAgZ2VvbV9wb2ludCgpICtcbiAgZ2d0aXRsZShcIlBsb3QxXCIpXG5cbmFuc2NvbWJlICU+JSBnZ3Bsb3QoYWVzKHg9eDIseT15MikpICtcbiAgZ2VvbV9wb2ludCgpICtcbiAgZ2d0aXRsZShcIlBsb3QyXCIpIn0=
</div>
<div class="code_note">

</div>
<p>To plot a scatter plot of x vs y for each pair we will use a tool from the <code>tidyverse</code> called <code>ggplot</code>.</p>
<div data-datacamp-exercise="" data-height="600" data-encoded="true">
eyJsYW5ndWFnZSI6InIiLCJwcmVfZXhlcmNpc2VfY29kZSI6ImlmICghcmVxdWlyZShcImdncGxvdDJcIikpIGluc3RhbGwucGFja2FnZXMoXCJnZ3Bsb3QyXCIpXG5saWJyYXJ5KGdncGxvdDIpXG5pZiAoIXJlcXVpcmUoXCJkcGx5clwiKSkgaW5zdGFsbC5wYWNrYWdlcyhcImRwbHlyXCIpXG5saWJyYXJ5KGRwbHlyKVxuXG5hbnNjb21iZS5sbTAxIDwtIGxtKHkxIH4geDEsIGRhdGEgPSBhbnNjb21iZSlcbmFuc2NvbWJlLmxtMDIgPC0gbG0oeTIgfiB4MiwgZGF0YSA9IGFuc2NvbWJlKSIsInNhbXBsZSI6ImRhdDEgPC0gZGF0YS5mcmFtZShmaXQgPSBmaXR0ZWQoYW5zY29tYmUubG0wMSksXG4gICAgICAgICAgcmVzID0gcmVzaWQoYW5zY29tYmUubG0wMSkpXG5cbmRhdDEgJT4lIGdncGxvdChhZXMoeD1maXQseT1yZXMpKSArXG4gIGdlb21fcG9pbnQoKSArXG4gIGdndGl0bGUoXCJQbG90MVwiKVxuXG5kYXQyIDwtIGRhdGEuZnJhbWUoZml0ID0gZml0dGVkKGFuc2NvbWJlLmxtMDIpLFxucmVzID0gcmVzaWQoYW5zY29tYmUubG0wMikpXG5cbmRhdDIgJT4lIGdncGxvdChhZXMoeD1maXQseT1yZXMpKSArXG4gIGdlb21fcG9pbnQoKSArXG4gIGdndGl0bGUoXCJQbG90MlwiKSJ9
</div>
<div class="code_note">

</div>
<p>The focus in this lecture will be on checking that dependent variable is <strong>linearly</strong> related independent variables, the error term (also call the residues) show no pattern, and that the error term (residues) is reasonably close to being normally distributed.</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="dealing-with-catagorical-data.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/LJKelly3141/StatisticsForEconomics/edit/master/01_Regression.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/LJKelly3141/StatisticsForEconomics/blob/master/01_Regression.Rmd",
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
